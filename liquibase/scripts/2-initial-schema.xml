<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">
    <changeSet id="2" author="Nikola Drljaca">
        <sql>
CREATE TABLE IF NOT EXISTS klink (
    id uuid PRIMARY KEY,
    name text
        NOT NULL,
    description text,
    created_at timestamp DEFAULT now() 
        NOT NULL,
    modified_at timestamp DEFAULT now()
        NOT NULL
);

CREATE TABLE IF NOT EXISTS klink_entry (
    id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
    klink_id uuid 
        REFERENCES klink(id) 
        ON DELETE CASCADE,
    value text
        NOT NULL
);  

CREATE TABLE IF NOT EXISTS klink_key (
    id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
    read_key varchar(8)
        NOT NULL,
    write_key varchar(8)
        NOT NULL,
    klink_id uuid
        REFERENCES klink(id)
        ON DELETE CASCADE
);
        </sql>
    </changeSet>

</databaseChangeLog>
